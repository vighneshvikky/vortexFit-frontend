<!-- admin-dashboard.component.html -->
<div class="dashboard-container">
  <!-- Loading State -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner"></div>
    <p>Loading dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-message">
    <div class="error-icon">âš ï¸</div>
    <h3>Error Loading Dashboard</h3>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadDashboardData()">Retry</button>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error && dashboardStats" class="dashboard-content">
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card purple">
        <div class="stat-icon">ğŸ‘¥</div>
        <div class="stat-content">
          <h3>Total Users</h3>
          <p class="stat-number">{{ dashboardStats.users.total | number }}</p>
          <span class="stat-badge"
            >+{{ dashboardStats.users.newThisMonth }} this month</span
          >
        </div>
      </div>

      <div class="stat-card pink">
        <div class="stat-icon">ğŸ’ª</div>
        <div class="stat-content">
          <h3>Trainers</h3>
          <p class="stat-number">
            {{ dashboardStats.trainers.total | number }}
          </p>
          <span class="stat-badge">Active</span>
        </div>
      </div>

      <div class="stat-card cyan">
        <div class="stat-icon">ğŸ“…</div>
        <div class="stat-content">
          <h3>Bookings</h3>
          <p class="stat-number">
            {{ dashboardStats.bookings.total | number }}
          </p>
          <span class="stat-badge">Total</span>
        </div>
      </div>

      <div class="stat-card green">
        <div class="stat-icon">ğŸ’³</div>
        <div class="stat-content">
          <h3>Subscriptions</h3>
          <p class="stat-number">
            {{ dashboardStats.subscriptions.total | number }}
          </p>
          <span class="stat-badge">Active</span>
        </div>
      </div>

      <div class="stat-card revenue purple-gradient">
        <div class="stat-icon">ğŸ’°</div>
        <div class="stat-content">
          <h3>Total Revenue</h3>
          <p class="stat-number">
            {{ formatCurrency(dashboardStats.revenue.total) }}
          </p>
          <span class="stat-badge">All time</span>
        </div>
      </div>

      <div class="stat-card revenue pink-gradient">
        <div class="stat-icon">ğŸ“Š</div>
        <div class="stat-content">
          <h3>Monthly Revenue</h3>
          <p class="stat-number">
            {{ formatCurrency(dashboardStats.revenue.monthly) }}
          </p>
          <span class="stat-badge">This month</span>
        </div>
      </div>
    </div>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <!-- Revenue by Source -->
      <div class="chart-card">
        <canvas id="revenueSourceChart"></canvas>
      </div>

      <!-- Booking Status -->
      <div class="chart-card">
        <canvas id="bookingStatusChart"></canvas>
      </div>

      <!-- Subscription Plans -->
      <div class="chart-card">
        <canvas id="subscriptionPlanChart"></canvas>
      </div>

      <!-- User Fitness Goals -->
      <div class="chart-card">
        <canvas id="fitnessGoalsChart"></canvas>
      </div>

      <!-- Monthly Revenue Trend -->
      <div class="chart-card wide">
        <canvas id="monthlyRevenueChart"></canvas>
      </div>
    </div>

    <!-- Top Trainers Table -->
    <div class="table-card" *ngIf="bookingAnalytics">
      <h2>Top Performing Trainers</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Rank</th>
              <th>Name</th>
              <th>Email</th>
              <th>Bookings</th>
              <th>Revenue</th>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let trainer of bookingAnalytics.topTrainers;
                let i = index
              "
            >
              <td>
                <span class="rank-badge" [class.top-3]="i < 3">{{
                  i + 1
                }}</span>
              </td>
              <td class="trainer-name">{{ trainer.trainerName }}</td>
              <td class="trainer-email">{{ trainer.trainerEmail }}</td>
              <td>
                <span class="booking-count">{{ trainer.bookingCount }}</span>
              </td>
              <td class="revenue-amount">
                {{ formatCurrency(trainer.totalRevenue) }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
